<!DOCTYPE html>
<html>
  <head>
    <title>Analytical solutions of SIR models – Mihály Koltai – personal website</title>

        <meta charset="utf-8" />
    <meta content='text/html; charset=utf-8' http-equiv='Content-Type'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1.0'>

    
    <meta name="description" content="Stationary behavior of compartmental epidemic models" />
    <meta property="og:description" content="Stationary behavior of compartmental epidemic models" />
    
    <meta name="author" content="Mihály Koltai" />

    
        






    


    
    <meta property="og:title" content="Analytical solutions of SIR models" />
    <meta property="twitter:title" content="Analytical solutions of SIR models" />
    


    <!--[if lt IE 9]>
      <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <link rel="stylesheet" type="text/css" href="/style.css" />
    <link rel="alternate" type="application/rss+xml" title="Mihály Koltai - personal website" href="/feed.xml" />

    <!-- Created with Jekyll Now - http://github.com/barryclark/jekyll-now -->
    <!-- Begin Jekyll SEO tag v2.5.0 -->
<title>Analytical solutions of SIR models | Mihály Koltai</title>
<meta name="generator" content="Jekyll v3.7.3" />
<meta property="og:title" content="Analytical solutions of SIR models" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Stationary behavior of compartmental epidemic models" />
<meta property="og:description" content="Stationary behavior of compartmental epidemic models" />
<link rel="canonical" href="http://localhost:4000/covid-modeling/" />
<meta property="og:url" content="http://localhost:4000/covid-modeling/" />
<meta property="og:site_name" content="Mihály Koltai" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2020-04-18T00:00:00+01:00" />
<script type="application/ld+json">
{"url":"http://localhost:4000/covid-modeling/","@type":"BlogPosting","headline":"Analytical solutions of SIR models","dateModified":"2020-04-18T00:00:00+01:00","datePublished":"2020-04-18T00:00:00+01:00","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/covid-modeling/"},"description":"Stationary behavior of compartmental epidemic models","@context":"http://schema.org"}</script>
<!-- End Jekyll SEO tag -->


  </head>

  <body>
    <div class="wrapper-masthead">
      <div class="container">
        <header class="masthead clearfix">
          <a href="/" class="site-avatar"><img src="" /></a>

          <div class="site-info">
            <h1 class="site-name"><a href="/">Mihály Koltai</a></h1>
         <!--    <p class="site-description">personal website</p> -->
          </div>

          <nav>
            <a href="/">about</a>
            <a href="/papers">publications</a>
            <a href="/blog">science</a>
            <a href="/ecopol">econ</a>
            <!-- <a href="/other">other</a> -->
          </nav>
        </header>
      </div>
    </div>

    <div id="main" role="main" class="container">
      <article class="post">
  <h1>Analytical solutions of SIR models</h1>

  <div class="entry">
    <p>These notes were written in the early stage of the COVID19 pandemic and they explore general properties of compartmental transmission (SIR-type) models.<br />
The models below make no specific predictions, instead I am only looking at their general mathematical properties.</p>

<h3 id="sir-models"><ins>SIR models</ins></h3>

<p>Let’s start with the simplest epidemic model, ie. the SIR compartmental model, where we have:<br />
<script type="math/tex">\frac{dS(t)}{dt}{=}{-}\alpha S(t) I(t) \\
\frac{dI(t)}{dt}{=}\alpha S(t) I(t)-\beta I(t) \\
\frac{dR(t)}{dt}{=}\beta I(t)
\tag{1}\label{SIR_odes}</script></p>

<p>It is more convenient to work with fractions of a population (and not absolute numbers), so that we have the conservation <script type="math/tex">S(t){+}I(t){+}R(t){=}1</script>.
We need to keep in mind that this is a mean field ODE model and <strong>has many limitations</strong>. It assumes complete homogeneity of transmission events, ie. that they depend only on the <em>fraction</em> of the population susceptible and infected and that for given values of these fractions we have the same rate of transmissions.
This also means that any small nonzero values for the infected population will lead to transmissions, whereas in reality a very small fraction can mean so few infected individuals that the epidemic can just die out. Also, in reality transmission events (very probably) do <em>not</em> occur homogeneously, proportionally to the infected (and susceptible) fraction of the entire population, but are much more clustered, local and occurring in certain environments, in burst-like (‘superspreader’) events.
For these reasons it is important to stress that these SIR models should be interpreted very cautiously and we must keep in mind their assumptions that are not entirely correct.
Nevertheless, they can give us a first idea of some general properties of epidemic dynamics and that’s what I want to do here. For predictions and planning more advanced models that take into account local environments, stochasticity, rare spreading events etc should be used, and it can also be useful to use <a href="https://static1.squarespace.com/static/5b68a4e4a2772c2a206180a1/t/5e8e5ac9e696ba4b972093fa/1586387658680/Modeling2.pdf">very simple but probabilistic models</a>.</p>

<p>In the SIR framework it is clear that <script type="math/tex">I(\infty){=}0</script>, since this variable has first-order (linear) decay, so any nonzero value in this compartment eventually ‘leaks out’ into <script type="math/tex">R</script>.
Therefore the equilibrium of the system is <script type="math/tex">(\overline{S},0,\overline{R})</script> and due to the conservation <script type="math/tex">\overline{R}{=}1{-}\overline{S}</script>. So to characterize the stationary behavior of the system all we need to calculate is
<script type="math/tex">\overline{S}</script>.</p>

<p>Of course this can be done by numerically integrating the ODEs in \ref{SIR_odes} and indeed half the internet is full of SIR-models now. But how about an <a href="http://http://mbkoltai.github.io/exastolog/">exact solution</a>?<br />
In this very clear <a href="https://www.nature.com/articles/s41591-020-0883-7">paper in Nature Medicine</a> (and probably others before) the authors explicitly derive the stationary solution for a more complicated model of 8 variables they abbreviate as the ‘SIDARTHE’ model.
Despite the apparent complexity this model is basically identical to the simple SIR model. The only difference is that 1) the <script type="math/tex">I</script> variable is split into several sub-variables (<strong>I</strong>: infected, a-/presymptomatic, undetected, <strong>D</strong>: diagnosed (asymptomatic infected, detected); <strong>A</strong>: ailing (symptomatic infected, undetected); <strong>R</strong>: recognized (symptomatic infected, detected); <strong>T</strong>: threatened (infected with life-threatening symptoms, detected)) 2) the sink variable <strong>R</strong> of the SIR model is split into two sinks (<strong>H</strong>: healed (recovered); <strong>E</strong>: extinct (dead)). However the <script type="math/tex">IDART</script> ‘module’ (the five state variables representing different stages of infection) has the same basic property as <strong>I</strong>, namely that in <script type="math/tex">t{\rightarrow}\infty</script> they decay to 0, and only <strong>S</strong>, <strong>H</strong>, <strong>E</strong> can have nonzero values.</p>

<p>For the simple SIR model defined of \ref{SIR_odes} the solution for the stationary value of <script type="math/tex">\overline{S}</script> is less complicated than in the latter model, ie. it is given by the implicit expression:<br />
<script type="math/tex">\frac{\alpha}{\beta} \overline{S} - log\overline{S} = \frac{\alpha}{\beta} - logS(0)
\tag{2}\label{SIR_S_stationary}</script></p>

<p>This can be solved by an efficient algebraic solver such as <script type="math/tex">fsolve</script> in MATLAB.
Let us do a parameter sweep in the <script type="math/tex">\frac{\alpha}{\beta}</script> ratio and the initial value of <script type="math/tex">S(0)</script>, and look at the stationary solution of <strong>R</strong>, ie. the fraction of the population that went through infection (ie. is now immune, if there is long-term immunity). Let us also check if the algebraic formula is the same as integrating the ODEs of \ref{SIR_odes} for a long time span:
<img src="/images/covid/SIR_immune_pop_algebr_ode_sol.png" alt="_config.yml" />
<em>Figure 1: Stationary solutions of SIR model calculated by simulations (left) and exact calculations (right)</em></p>

<p>Fortunately the analytical solutions from \ref{SIR_S_stationary} are identical with the numerical solutions of the ODEs, so we didn’t make a mistake in \ref{SIR_S_stationary}.<br />
What do we see from this plot? The <script type="math/tex">\frac{\alpha}{\beta}</script> ratio is the famous <script type="math/tex">R_0</script>, the basic reproduction parameter, and logically, the larger this ratio is, the more of the population will go through infection (again, in the framework of this extremely simplified model not meant to be realistic).
It is also intuitive that if <script type="math/tex">S(t{=}0)</script> is smaller because of a larger initial infected population <script type="math/tex">I(0)</script>, then <script type="math/tex">\overline{H}{+}\overline{E}</script> will be larger.</p>

<p>Now, let us make the model one step more refined, and split <strong>R</strong> into two variables, <strong>H</strong>(ealed) and <strong>E</strong>(xtinct , ie. deceased), as:</p>

<p><img src="/images/covid/SIHE_cropped_resiz.png" alt="_config.yml" />
<em>Figure 2: ‘SIHE’ version of the SIR model where <strong>R</strong>(recovered) is split into <strong>H</strong> and <strong>E</strong></em></p>

<p>The <strong>I</strong>(nfected) variable now has two outcomes. It is clear intuitively that this will not change how the stationary solution of <script type="math/tex">\overline{S}</script> is calculated, as the sink nodes do not interact with <strong>S</strong>, except that now <strong>I</strong> has two outgoing flows, so it is the ratio <script type="math/tex">\frac{\alpha}{\lambda{+}\tau}</script> that will define <script type="math/tex">\overline{S}</script> as:
<script type="math/tex">\frac{\alpha}{\lambda{+}\tau} \overline{S} - log\overline{S} = \frac{\alpha}{\lambda{+}\tau} - logS(0)
\tag{3}\label{SIHE_statsol_S}</script></p>

<p>Moreover we can give the formulas for <script type="math/tex">\overline{H}, \overline{E}</script> as a function of <script type="math/tex">\overline{S}</script> and the initial infected population <script type="math/tex">I(0)</script>.
It is reasonable to assume <script type="math/tex">H(0), E(0)</script> are 0.
Downstream of <strong>I</strong> the dynamics is completely linear: what flows out from <strong>S</strong> into <strong>I</strong> (ie. <script type="math/tex">\Delta{S}{=}S(0){-}\overline{S}</script>), as well as the initial concentration of <script type="math/tex">I(0)</script> will be partitioned into the sink variables proportionally to the rate constants <script type="math/tex">\lambda</script> and <script type="math/tex">\tau</script>. Specifically, we’ll have:<br />
<script type="math/tex">\overline{H} = [(S(0)-\overline{S}) + I(0)] \frac{\lambda}{\lambda{+}\tau}\\
\overline{E} = [(S(0)-\overline{S}) + I(0)] \frac{\tau}{\lambda{+}\tau}  
\tag{4}\label{SIHE_statsol_H_E}</script></p>

<p>The ratio <script type="math/tex">\frac{\tau}{\lambda{+}\tau}</script> is the infection fatality (IFR) rate.
It is clear from \ref{SIHE_statsol_S} that the IFR does not affect <script type="math/tex">\overline{S}</script> if the sum <script type="math/tex">\lambda{+}\tau</script> is kept constant, it is instead the ratio of <script type="math/tex">\alpha</script> (rate constant of new infections) to these two parameters that determine at what level of total infections the epidemic stops.
To check if the formulas are correct, let us again compare the exact solution to the numerical solution of the ODEs, and plot the stationary solutions of <script type="math/tex">\overline{S},</script> at different IFR values:
<img src="/images/covid/SIHE_algebr_ode_IFRscan.png" alt="_config.yml" />
<em>Figure 3: stationary solutions of SIHE model at S(0)=0.99 and four different values of the IFR</em></p>

<p>Circles show the results from numerical integration of the ODEs, confirming they are identical with the analytical solutions (lines). The fraction of the population that has not been infected throughout the epidemic (<script type="math/tex">\overline{S}</script>) goes down with <script type="math/tex">\frac{\alpha}{\lambda{+}\tau}</script>, but is independent of the IFR as the sum <script type="math/tex">{\lambda{+}\tau}</script> was kept constant here. The ratio <script type="math/tex">\frac{\alpha}{\lambda{+}\tau}</script> expresses how fast subjects exit the infectious state relative to the rate constant of generating new infections. A higher ratio means more of the population is infected, which is <script type="math/tex">\overline{H}+\overline{E}=(S(0){-}\overline{S}){+}I(0)</script>.
In contrast, if both <script type="math/tex">\alpha</script> and <script type="math/tex">\lambda{+}\tau</script> are equally scaled then this quantity does not change.<br />
How the infected fraction of the population is partitioned between the two sink states (<script type="math/tex">\overline{H}, \overline{E}</script>) obviously depends on the IFR (note the logarithmic scale), as stated in \ref{SIHE_statsol_S}.
Note that while the IFR is ‘hard-wired’ in the parameter ratio <script type="math/tex">\frac{\tau}{\tau+\lambda}</script>, how much of the population gets infected and dies depends on <script type="math/tex">\overline{S}</script> and therefore <script type="math/tex">\alpha</script>, the rate constant for transmission. This is where physical distancing measures would intervene to choke off the flow <script type="math/tex">{S}\rightarrow{I}</script>.</p>

<p>Let us go now one step further and allow for a pre-symptomatic state, defining <strong>I</strong> as a variable of the infectious but pre-symptomatic state and adding a variable <strong>A</strong>(iling) that is the infectious and symptomatic state. Now the compartments of this ‘<em>SIAHE</em>’ model and the flows between them are:</p>

<p><img src="/images/covid/SIAHE_res.jpeg" alt="_config.yml" />
<em>Figure 4: ‘SIAHE’ SIR model with presymptomatic (<strong>I</strong>) and symptomatic (<strong>A</strong>) infectious state and two outcomes</em></p>

<p>By highlighting the <script type="math/tex">{S}\rightarrow{I}</script> flow in red I want to indicate that this is the (only) nonlinear term, and now this flow has two parameters as the ODE for <strong>S</strong> is:<br />
<script type="math/tex">\frac{dS(t)}{dt} = -S(t)(\alpha I(t) + \gamma A(t))</script></p>

<p>These two bilinear terms are positive feedbacks on the otherwise linear system. If it wasn’t for these terms the system would have an equilibrium where only the <a href="http://vcp.med.harvard.edu/papers/jg-lap-dyn.pdf">terminal vertices</a> (<script type="math/tex">H, E</script>) of its graph can have nonzero value, just like with the equilibrium we have for the <a href="https://mbkoltai.github.io/exastolog">state transition graph of a stochastic Boolean model</a>.
Because of this nonlinear feedback however <strong>S</strong> can (and usually does) also have a nonzero value in steady state, so the equilibrium of SIAHE is <script type="math/tex">(\overline{S},0,0,\overline{H},\overline{E})</script>.</p>

<p>Let us again get the formula for <script type="math/tex">\overline{S}</script>. Ff we have this, the rest of the system has linear kinetics, so the stationary values of <strong>H</strong> and <strong>E</strong> will follow easily from the kinetic matrix of the IAHE variables. I follow here the derivation from the Nature Medicine article, except that it is for a simpler (5 variables) model.</p>

<p>We need to introduce some notation:<br />
<script type="math/tex">% <![CDATA[
x(t){=}\begin{bmatrix} I(t) \\ A(t) \end{bmatrix},
c{=}\begin{bmatrix} \alpha \\ \gamma \\ \end{bmatrix},
b{=}\begin{bmatrix} 1 \\ 0 \end{bmatrix},
F{=}\begin{bmatrix} -(\lambda{+}\zeta)&{0}\\{\zeta}& -(\kappa{+}\tau) \end{bmatrix} %]]></script></p>

<p>Then the ODE for <script type="math/tex">I(t)</script> and <script type="math/tex">A(t)</script> is:<br />
<script type="math/tex">\dot{x(t)}{=}F x(t) + b c^T x(t) S(t)</script></p>

<p>Since <script type="math/tex">\dot{S}(t){=}-c^T x(t) S(t)</script> we can substitute this in and get:  <br />
<script type="math/tex">\dot{x(t)}{=}F x(t) - b  \dot{S}(t)</script></p>

<p>Then integrating (and changing <script type="math/tex">t</script> to <script type="math/tex">\phi</script>), for the left side:<br />
<script type="math/tex">\int_0^\infty \dot{x}(\phi) d\phi = x(\infty){-}x(0){=}-x(0)</script></p>

<p>…and on the right hand side we have:<br />
<script type="math/tex">F\int_0^\infty x(\phi) d\phi - b \int_0^\infty \dot{S}(\phi) =
F\int_0^\infty x(\phi) d\phi - b(\overline{S}-S(0))</script></p>

<p>so then we have:<br />
<script type="math/tex">-x(0){=}F\int_0^\infty x(\phi) d\phi - b(\overline{S}-S(0))</script></p>

<p>Now if we pre-multiply by <script type="math/tex">c^T F^{-1}</script> (a [1x2] vector) to get rid of F and to turn both sides into scalars we get:<br />
<script type="math/tex">-c^T F^{-1} x(0) =\int_0^\infty c^T x(\phi) d\phi - c^T F^{-1} b(\overline{S}-S(0))</script></p>

<p>From the ODE of <script type="math/tex">\dot{S}</script> we can substitute <script type="math/tex">\frac{\dot{S(t)}}{S(t)}</script> into <script type="math/tex">c^T x(t)</script>:<br />
<script type="math/tex">-c^T F^{-1} x(0){=} - \int_0^\infty \frac{\dot{S}(\phi)}{S(\phi)} d\phi - c^T F^{-1} b(\overline{S}-S(0)) = log \frac{S(0)}{\overline{S}} - c^T F^{-1} b(\overline{S}-S(0))</script></p>

<p>Then after a rearrangement we have the solution for <script type="math/tex">\overline{S}</script> in the same form as for the ‘<em>SIHE</em>’ model in \ref{SIHE_statsol_S}:<br />
<script type="math/tex">-c^T F^{-1}b \overline{S} - log \overline{S} = -c^T F^{-1}b S(0) - log S(0) + c^T F^{-1} x(0)</script></p>

<p><script type="math/tex">-c^T F^{-1} b</script> is the <script type="math/tex">R_0</script> of this version of the model, so rewriting with <script type="math/tex">R_0</script>:<br />
<script type="math/tex">R_0 \overline{S}- log \overline{S} = R_0 S(0) - log S(0) + c^T F^{-1} x(0)
\tag{5}
\label{SIAHE_S_statsol_R0}</script></p>

<p>Explicitly, <script type="math/tex">R_0</script> is:<br />
<script type="math/tex">R_0{=}\frac{\alpha}{\lambda+\zeta}{+}\frac{\zeta \gamma}{(\kappa+\tau)(\lambda+\zeta)}</script></p>

<p><script type="math/tex">R_0</script> is linearly increasing in the contagion rates <script type="math/tex">\alpha</script> and <script type="math/tex">\gamma</script>, while decreasing in the rate constants of the outgoing flows of <strong>I</strong> and <strong>A</strong>, ie. <script type="math/tex">\kappa, \tau, \lambda</script>.
<script type="math/tex">\zeta</script> has a more complicated effect as it decreases the first term, but increases the second. This makes sense too, since this is the rate constant <em>between</em> the two contagious states <strong>I</strong> and <strong>A</strong>.</p>


  </div>

  <div class="date">
    Written on April 18, 2020
  </div>

  <span>[
  
    
    <a href="/tag/epidemics"><code class="highligher-rouge"><nobr>epidemics</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/complex-systems"><code class="highligher-rouge"><nobr>complex-systems</nobr></code>&nbsp;</a>
  
    
    <a href="/tag/covid19"><code class="highligher-rouge"><nobr>covid19</nobr></code>&nbsp;</a>
  
]</span>





<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  TeX: { equationNumbers: { autoNumber: "AMS" } },
  "HTML-CSS": { linebreaks: { automatic: true, width: "75% container"  } },
         SVG: { linebreaks: { automatic: true, width: "75% container"  } }
});
</script>

<script>
       MathJax.Hub.Config({
           config: ["MMLorHTML.js"],
           extensions: ["tex2jax.js","TeX/AMSmath.js","TeX/AMSsymbols.js"],
           jax: ["input/TeX"],
           tex2jax: {
               inlineMath: [ ['$','$'], ["\\(","\\)"] ],
               displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
               processEscapes: false
           },
           TeX: {
               TagSide: "right",
               TagIndent: ".8em",
               MultLineWidth: "85%",
               equationNumbers: {
                  autoNumber: "AMS",
               },
               unicode: {
                  fonts: "STIXGeneral,'Arial Unicode MS'"
               }
           },
           showProcessingMessages: false
       });
</script>


</article>

    </div>

    <div class="wrapper-footer">
      <div class="container">
        <footer class="footer">
          



<a href="https://github.com/mbkoltai"><i class="svg-icon github"></i></a>

<a href="https://www.linkedin.com/in/mihaly-koltai"><i class="svg-icon linkedin"></i></a>


<a href="https://www.twitter.com/mbkoltai"><i class="svg-icon twitter"></i></a>



        </footer>
      </div>
    </div>

    

  </body>
</html>
